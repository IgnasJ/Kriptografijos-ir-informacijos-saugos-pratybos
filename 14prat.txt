
p=6117141027690268863066571918245810640257047
q=3614400726037367687998927967
g=2787963272395736542676824131554062496484784
g1=4680669110736185727425831912429247848314163
g2=4592150317962620833846601769447027758425059
h=4465155147933291453327545675090976854232345
U = 1995
I = power_mod(g1,U,p)
print I
z=4927846865957173805951812176667538582046701
a = 4879479323144790834021445997253174885761519
b = 862746584991084131918105071130777514567687

s = 11
x1 = 12
x2 = 13
u = 1995
v = 14

A = power_mod(I*g2,s,p)
print "A" , A
B = power_mod(g1,x1,p)*power_mod(g2,x2,p)%p
print "B" , B
zstr = power_mod(z,s,p)
print "z'" , zstr
astr = power_mod(a,u,p)*power_mod(g,v,p)%p
print "a'" , astr
bstr = power_mod(b,s*u,p)*power_mod(A,v,p)%p
print "b'" , bstr
print A, B, zstr, astr, bstr

hashas = 507168393278355293846319809

c = hashas*1/u%q
print "c", c

r=1919660307732988604914290096  

rstr = (r*u+v)%q
print "rstr", rstr

print A, B, zstr, astr, bstr, rstr

d = 1689706513441064926712016622

r1 = (d*U*s + x1)%q
r2 = (d*s+x2)%q

print r1, r2

print r1, r2, d, A, B


Rysys su banku
Ivesti: 5233691491988959307585542959795785499933834


Iš banko gauta z=4927846865957173805951812176667538582046701

Banko rakto komponentės=[p,q,g,g_1,g_2,h]
p=6117141027690268863066571918245810640257047
q=3614400726037367687998927967
g=2787963272395736542676824131554062496484784
g1=4680669110736185727425831912429247848314163
g2=4592150317962620833846601769447027758425059
h=4465155147933291453327545675090976854232345

Bankas atsiuntė [a,b]
[4879479323144790834021445997253174885761519, 862746584991084131918105071130777514567687]


Moneta: 5286901879215243893174338882564765324544014 72561637297945958028355474733698795092678 4763321631448802217571360434147429875553362 4060703144359380696962636472462632616097218 75640659672230113089211683796195497767304 2071945053739885213144024481

Pardavėjo atsakymas:
Duomenys patvirtinimui
1689706513441064926712016622


Ačiū, kad perkate mūsų parduotuvėje!
 Kvito numeris: 5505335864463065470752874078005984759898384

Jūsų ElGamalio schemos rakto dalis 
[x,y]=[851507853353676798339543113, 1563240448267398839358959182]
[x,y]=[2084568990104723748457126656, 1895278832799466977087075037]
[x,y]=[1241913588092382508927292161, 1593760131700752168631768605]
[x,y]=[1173585918637642312960291359, 2207573028058206925369532099]
[x,y]=[1857297277633473333872898847, 2256368104188891849595396072]